---
# type: docs
title: "ðŸ‡©ðŸ‡ª â™Š [Geminocks] Der Akku meines MacsðŸ”‹ in Google Cloud Monitoring â€” SMS senden, wenn er niedrig ist ðŸª«"
date: 2022-11-09T11:48:51+01:00
featured: false
draft: false
comment: true
toc: true
reward: true
pinned: false
carousel: false
series:
categories: [ GCP, Work ]
tags: [GCP, macbook, SMS, pager, medium, geminocks, German ]
images:
- /images/articles/london-airport.jpg
meta_image: featured-sample.jpg # This is for ZZO
#- /images/battery-life-cli.webp
#- /images/london-airport.jpg
# original TODO more from https://medium.com/google-cloud/my-macs-battery-on-google-cloud-monitoring-with-sms-if-its-low-a1ccd70485fe
---

<!-- this works: ![Image Caption](/images/riccardo.jpg "Use Image Title as Caption aeroporto") -->
![Image Caption](/images/articles/london-airport.jpg "[HUGO] Ich nehme den Zug zum City Airport, meinem Lieblingsflughafen in London")


Dieser Artikel zeigt, wie Sie auf einfache Weise einen generischen SchlÃ¼ssel/Wert in Google Cloud Monitoring einfÃ¼gen und darauf basierend Warnungen einrichten kÃ¶nnen. Ich verwende dies, um Warnungen bei geringem Festplattenspeicherplatz und jetzt auch bei niedrigem Akkustand zu erhalten!

Heute Morgen war ich in London und habe mein LadegerÃ¤t zu Hause vergessen. Ich hatte zwar noch viel Zeit, aber ðŸª« wenig Akku, und dachte mir: Hey! Ich brauche eine MÃ¶glichkeit, vorherzusehen, wann mein Akku leer ist! Und ich muss das auf eine total Ã¼bertriebene Weise tun!

<!--more-->

Mein Akku war bei 42 %, was mir wie ein subtiles Zeichen dafÃ¼r vorkam, dass meine Idee es wert war, darÃ¼ber zu bloggen. Bei der Google-Suche stieÃŸ ich auf einen Artikel, der mir den Tipp gab, wie ich den Akku meines Macs per Skript abfragen kann (beachten Sie, dass dies nur bei einem Macbook funktioniert).

HÃ¤sslicher Code hier (hey! Ich bin in einem Flughafen ohne LadegerÃ¤t, wollen Sie auch noch Unit-Tests?!?):

```ruby
#!/usr/bin/env ruby

# Anmerkung 1: buridone wird derzeit nicht verwendet. Es ist fÃ¼r eine effizientere Nutzung gedacht, um alle Informationen aus einem einzigen Dateilesevorgang zu extrapolieren.
# Anmerkung 2: Dies funktioniert NICHT auf M1. Ich habe das gerade im Github-Repo sakura behoben. Den aktualisierten 0.2-Code finden Sie dort.
def processMacCapacity(buridone)
  ret = {}
  ret[:debug] = 'Ich werde ZÃ¤hler und Nenner fÃ¼llen, bis ich es richtig hinbekomme.'
  ret[:capacity_pct] = 142 # eindeutig falsch
  # `ioreg -l -w0 | grep AppleRawMaxCapacity`.split
  # => ["|", "|", "\"AppleRawMaxCapacity\"", "=", "4320"]
  ret[:AppleRawMaxCapacity] = `ioreg -l -w0 | grep AppleRawMaxCapacity`.split[4].to_i
  ret[:AppleRawCurrentCapacity] = `ioreg -l -w0 | grep AppleRawCurrentCapacity`.split[4].to_i
  #  => ["\"StateOfCharge\"=41"]
  ret[:StateOfCharge] = `ioreg -l -w0 | grep BatteryData`.split(',').select{|e| e.match /StateOfCharge/ }[0].split('=')[1].to_i
  ret[:AppleDesignCapacity] = `ioreg -l -w0 | grep BatteryData`.split(',').select{|e| e.match /DesignCapacity/ }[0].split('=')[1].to_i

  # abgeleitete Werte..
  # das sollte Ihre Akkulaufzeit sein, schÃ¤tze ich?x
  ret[:BatteryCapacityPercent] = ret[:AppleRawCurrentCapacity]*100.0/ret[:AppleRawMaxCapacity]
  ret[:battery_health] =  ret[:AppleRawMaxCapacity]*100.0/ret[:AppleDesignCapacity]

  return ret
end

def real_program
  capacity_hash = processMacCapacity(`ioreg -l -w0 | grep Capacity`)
  deb "capacity_hash: '''#{white capacity_hash}'''"
  if $DEBUG
    capacity_hash.each{|k,v|
      puts "[DEB] #{k}:\t#{v}"
  }
  end
  puts "1. ðŸ”‹ Akkulaufzeit % ðŸ”ŒðŸª«: #{capacity_hash[:BatteryCapacityPercent].round(2)}"
  puts "2. ðŸ”‹ Akkuzustand % ðŸ›Ÿ: #{capacity_hash[:battery_health].round(2)}"
end

def main(filename)
  deb "Ich werde aufgerufen von #{white filename}"
  init        # Aktivieren Sie dies, um Befehlszeilen-Parsing-Funktionen zu erhalten!
  real_program
end

main(__FILE__)
```


Ich weiÃŸ, ich rufe den gleichen Befehl 10 Mal auf und kÃ¶nnte ihn zwischenspeichern. Das ist fÃ¼r die nÃ¤chste Iteration!

Das Beste daran ist, dass ich nicht nur meine Akkulaufzeit angezeigt bekomme, sondern auch die Haltbarkeit meines Akkus - also wann ich den Akku wechseln muss. Woohoo!

Los geht's, probieren wir es aus, ich ziehe nur kurz das Kabel ab, damit Sie keine langweiligen 100 % angezeigt bekommen.

![Image Caption](/images/articles/battery-life-cli.webp "Hier sind meine Akkulaufzeit und mein Akkuzustand")

TODO(ricc): fertigstellen


[Artikel auf Medium lesen](https://medium.com/google-cloud/my-macs-battery-on-google-cloud-monitoring-with-sms-if-its-low-a1ccd70485fe)


*(Generated by Geminocks: https://github.com/palladius/ricc.rocks/tree/main/gemini prompt_version=1.4)*