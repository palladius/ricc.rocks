---
title: "üá´üá∑ ‚ôä [Geminocks] Boostez vos applications Rails avec Cloud Run : une plong√©e profonde dans Qwiklabs"
date: 2024-08-15  # Today's date
layout: single  # Assuming single.html for blog posts in ZZO theme
# Optional fields (change as needed)
author: Riccardo Carlesso
read_time: 3  # Minutes
# categories: Add categories if applicable (e.g., ruby, rails, gcp)
Tags: [geminocks, French, qwiklabs, cloudrun, rubyonrails, devops, gcp, googlecloud, toolchain, skillsboost, cloudskillsboost ]
canonicalURL: https://medium.com/@palladiusbonton/ruby-on-rails-with-postgresql-on-cloud-run-bdaaf0b26e0b
# ![Riccardo Video on Youtube](/en/posts/medium/2024-10-19-level-up-rails/ricc-qwiklab-video.png)
---

([Article original sur Medium](https://medium.com/@palladiusbonton/ruby-on-rails-with-postgresql-on-cloud-run-bdaaf0b26e0b))

Connaissez-vous [Cloud Skills Boost](https://www.cloudskillsboost.google/) (anciennement connu sous le nom de Qwiklabs) ?

![Vid√©o de Riccardo sur Youtube](ricc-qwiklab-video.png)

Dans **[cette vid√©o](https://www.youtube.com/watch?v=vpPftSHE9kM)**, je vous montre comment j'ex√©cute les √©tapes d√©crites dans Ruby on Rails avec PostgreSQL sur Cloud Run sur le site web de cloudskillsboost, en rencontrant quelques obstacles en cours de route, et en les corrigeant.

De plus, je vais vous pr√©senter ma cha√Æne d'outils personnelle et particuli√®re, en tant qu'ancien d√©veloppeur bash/perl, elle peut donc vous sembler particuli√®re.

Si vous √™tes impatient de commencer, voici mon code final sur GitHub [lien vers le code](https://github.com/palladius/20240809-qwiklab-rails-on-gcp) et le Codelab RoR [lien vers le codelab](https://www.cloudskillsboost.google/focuses/20047).

Voici ma vid√©o sur Rails !

## **√Ä propos de Skillsboost**

Skillsboost (anciennement connu sous le nom de Qwiklabs) est un moyen de vous former √† Google Cloud en ex√©cutant des "labs". Ces labs sont limit√©s dans le temps, Google cr√©e toutes les ressources pour vous et les supprime √† la fin du lab.

Pour r√©aliser les labs, vous disposez d'un syst√®me de cr√©dits. Vous pouvez payer $$ pour les obtenir, ou vous pouvez en obtenir gratuitement en vous inscrivant simplement √† notre programme Innovator Champion (oui, tout est gratuit !). Cela devrait vous permettre de r√©aliser environ 10 labs gratuitement, √©galement avec Gemini (je les ai essay√©s, ils sont tr√®s amusants !).

Notre Codelab se trouve ici : https://www.cloudskillsboost.google/focuses/20047

## **L'approche de Riccardo pour Skillsboost**

Il existe plusieurs fa√ßons d'ex√©cuter un Lab, mais j'en vois principalement deux :

1. Vous ex√©cutez le code dans le Cloud. C'est le plus simple, ce que tout le monde fait. Vous utilisez une combinaison de Cloud Shell et de Cloud Editor (si vim ne vous convient pas).
2. Vous ex√©cutez le code localement. C'est un peu plus difficile √† mettre en place, mais vous pouvez ensuite conserver tout votre code utile localement pour une utilisation/un piratage ult√©rieur. J'ai pass√© quelques ann√©es √† √©crire une cha√Æne d'outils pour cela, en utilisant codelabba et proceed_if_error_matches et d'autres. Comme vous pouvez l'imaginer, je pense √™tre le seul terrien √† conserver mes scripts codelab quelque part localement. Suis-je en bonne compagnie ? N'h√©sitez pas √† me contacter et √† me dire ce que vous faites diff√©remment !

Comme vous pouvez le voir dans ma vid√©o, je fais les deux pour vous montrer les deux approches, ainsi que les avantages et les inconv√©nients.

## **Qu'est-ce qu'un journal de friction ?**

Un journal de friction est un document Google Doc dans lequel vous d√©crivez par √©crit votre exp√©rience, vos √©motions et m√™me votre niveau de col√®re (√† l'aide de codes couleurs) au d√©veloppeur d'un code/ressources. L'id√©e est ensuite de partager votre document avec l'impl√©menteur, en y suivant le code et les bogues du document. Mon id√©e folle est d'en faire une vid√©o !

## **Ma cha√Æne d'outils "codelabba"**

Le moment est venu d'expliquer ma cha√Æne d'outils personnelle. Habituellement, j'ai un certain nombre de d√©p√¥ts git sous `~/git/`, l'un d'entre eux √©tant Open Source. Bien s√ªr, je parle de palladius/sakura.

* `00-init.sh` : Le script d'initialisation, commun √† tous mes projets codelabba, il fait r√©f√©rence √† des variables ENV comme PROJECT_ID, REGION et ainsi de suite.

* `.envrc` : Ce fichier est aliment√© par `direnv`, un outil que m'a sugg√©r√© Rob Edwards et il contient toutes mes variables ENV. Vous pouvez le consid√©rer comme la partie hydratation du 00-init et de tout le reste, gr√¢ce aux biblioth√®ques Ruby/Python pour g√©rer les fichiers .env*. J'ai √©galement fait un effort pour que ce fichier fonctionne d'embl√©e avec Pulumi (en adoptant les noms de variables ENV standard de Pulumi) et pour qu'il soit aussi compatible que possible avec les codelabs de Google Cloud.

* `proceed_if_error_matches` : C'est le script le plus simple et le plus intelligent que j'ai jamais √©crit. Il transforme les scripts bash s√©quentiels avec `set -euo pipefail` en scripts bash ressemblant √† terraform. Imaginez que vous ayez besoin de : (1) cr√©er un bucket (2) d√©finir une ACL sur celui-ci (3) t√©l√©charger des fichiers sur celui-ci. Il est raisonnable de penser que vous avez trois scripts s√©quentiels, qui peuvent √©chouer de temps en temps et qu'il vous faut du temps pour corriger chaque ligne. Une fois que vous avez termin√©, vous voulez passer √† la suivante, mais devinez quoi ? Vous ne pouvez pas travailler sur (2) car (1) va commencer √† √©chouer avec un message ennuyeux comme "le bucket existe d√©j√†". J'ai donc pens√© - et si je pouvais filtrer UNIQUEMENT certains messages d'erreur, que je capture sous forme de cha√Ænes de caract√®res ? C'est la raison d'√™tre de ce fichier.

* `codelabba.rb` (propri√©taire) Il s'agit d'un script ruby que je n'ai jamais publi√© publiquement. Mais demandez-moi dans les commentaires, et je prendrai peut-√™tre le temps de le nettoyer et de le mettre en open source. Il cr√©e basiquement un squelette pour mes codelabs, et je l'ai invent√© la 2√®me ou 3√®me fois que je faisais un codelab Qwiklab, exactement pour les raisons que j'ai √©crites ci-dessus.

* `XX-blah-blah.sh` ([exemple](https://github.com/palladius/20240809-qwiklab-rails-on-gcp)) Ce sont des scripts √† ex√©cuter dans l'ordre : 01, 02, 03, ... afin qu'ils vous racontent une histoire. Voyez cela comme un "notebook python Bash". Je sais, c'est la phrase la plus profonde que vous allez lire aujourd'hui :)

Code : https://github.com/palladius/20240809-qwiklab-rails-on-gcp

## Conclusions

C'est une grande exp√©rience pour moi ! √âtait-ce une bonne id√©e ? Une terrible id√©e ? Faites-le moi savoir dans les commentaires !
