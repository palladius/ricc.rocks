---
title: "‚ôä [Geminocks] Setting a ‚¨£ Cloud Build trigger with \U0001F9F9Pulumi in \U0001F40D
  Python"
date: 2022-09-22 21:17:43.000000000 +01:00
draft: false
tags:
- symlink
- GCP
- pulumi
- CloudBuild
- Medium
canonicalURL: https://medium.com/google-cloud/setting-cloudbuild-with-pulumi-in-python-330e8b54b2cf
featured_image: "/images/gohugo-default-sample-hero-image.jpg"
image: "/images/mtg-clone.jpg"
geminock:
  :alter_front_matter_version: '1.0'
  :notes: Riccardo - todo make this variable per extension and calla  proper class
    to get it. So you can have a single thingie for Main picture, and then transform
    it for all extensions.
# Generated by Geminock v.1.0 - matter_hash_to_str()
# Note this operation might have removed all previous comments. Sorry.
# If Riccardo wants to edit this, code is in: /Users/ricc/git/ricc.rocks/gemini/lib/gemini/translator.rb
---

*[geminickl : DISABLED TRANSLATION BRO]*

The Original article here:  https://medium.com/google-cloud/setting-cloudbuild-with-pulumi-in-python-330e8b54b2cf

TODO(7feb23): add this video as embedded: https://www.youtube.com/watch?v=5jhWVNN8P_M (created on 6feb23)

A couple of weeks ago, I fell in love with **Pulumi**. it has everything I wanted from Terraform: easy to set up, easy config management, a nice UI for free, and most importantly‚Ä¶ language Support! Pulumi is the best invention after Buffalo Pizza and has only a problem.. [no Ruby support](https://github.com/pulumi/pulumi/issues/132) :/

Anyway, I‚Äôm so in love with ‚¨£ GCP (which happens to pay my salary, I got to admit), Cloud Build, Cloud Deploy, and in general CI/CD pipelines on Google Cloud that I wanted to give it a try. Googling ‚ÄúCloud Build Pulumi‚Äù I got to this nice article for JavaScript, which is not in my chords.

## The code

My code is here: https://github.com/palladius/pulumi/tree/main/examples/python-gcp-cloudbuild-auto-trigger

Note: üëç Code is finally building correctly. Yay!

![cb-trigger-list](01-cb-trigger-list.webp)


## What is so special about the code?

The code allows any Pulumi project you might have on GCP (in Python üêç) to set up a trigger to self-update. A push to the git repo will trigger a build job which ‚Äî if successful ‚Äî will login as yourself to Pulumi and issue an update with the new code.

So if, for instance, you commit a change that adds a GCS bucket to the code, in a couple of minutes that GCS bucket will be created and the README.md will be updated with builder parameters:

![cb-trigger-list](02-pulumi-commands.webp)
In bold you can see 3 parameters updated by Cloud Build itself!

My code supports **Github** (as is) and **Bitbucket** (code 99% there as it was working first!) for the moment.

I‚Äôve also customized the message as per Laura article, prepending a ‚Äú[built with Cloud Build]‚Äù to the git message (‚Äùslash N fix‚Äù, in this case):

![View on Pulumi website](03-trigger-build-on-pulumi-site.webp)

## What does Pulumi mean?

I‚Äôve been trying google Translate, it looks like it might mean broomstick (üßπ) in hawaiaan or Burma (üá≤üá≤, now Myanmar). Until then, I‚Äôll use the first emoji, until someone proves me wrong.

Edit: my friend Aaron from Pulumi confirms broom and points to [this article](http://joeduffyblog.com/2018/06/18/hello-pulumi/).

##  Next steps
My üìù for the future includes:

* Having proper password/state setting on GCP via HSM or GCS.
* Transform into a module so whichever pulumi project you might have you can just invoke this code with 4‚Äì5 variables (github user, github repo, pulumi buidl directory, credentials, ..). I still need to see if this is viable also cross-language (nonüêç).

## References

Original code (Cloud Build + Node.js): https://www.pulumi.com/docs/guides/continuous-delivery/google-cloud-build/

My code (python): https://github.com/palladius/pulumi/tree/main/examples/python-gcp-cloudbuild-auto-trigger


THIS WAS ORIGINAL PARSED CONTENT